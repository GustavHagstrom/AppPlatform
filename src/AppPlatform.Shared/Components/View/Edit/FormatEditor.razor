@using MudBlazor.Utilities
@inject IStringLocalizer<FormatEditor> Localizer

<ToolbarSection Title="@Localizer[SectionTitle]">
    <ToolbarRow>
        <ToolbarColumn>
            <ToolbarRow>
                <MudIconButton Variant="Variant.Outlined" Icon="@Icons.Material.Sharp.FormatBold" Style="background-color: var(--mud-palette-action-disabled-background)" />
                <MudIconButton Variant="Variant.Outlined" Icon="@Icons.Material.Sharp.FormatItalic" />
                <MudIconButton Variant="Variant.Outlined" Icon="@Icons.Material.Sharp.FormatUnderlined" />
            </ToolbarRow>
            <ToolbarRow>
                <MudMenu Dense="true" AnchorOrigin="Origin.BottomLeft" TransformOrigin="Origin.TopLeft">
                    <ActivatorContent>
                        <MudIconButton Variant="Variant.Outlined" Icon="@Icons.Material.Sharp.BorderBottom" />
                    </ActivatorContent>
                    <ChildContent>
                        <MudMenuItem Icon="@Icons.Material.Sharp.BorderBottom"/>
                        <MudMenuItem Icon="@Icons.Material.Sharp.BorderTop"/>
                        <MudMenuItem Icon="@Icons.Material.Sharp.BorderLeft"/>
                        <MudMenuItem Icon="@Icons.Material.Sharp.BorderRight"/>
                        <MudMenuItem Icon="@Icons.Material.Sharp.BorderClear" />
                   @*      <MudMenuItem Icon="@Icons.Material.Sharp.BorderAll" /> *@
                        <MudMenuItem Icon="@Icons.Material.Sharp.BorderOuter" />
                    </ChildContent>
                </MudMenu>
                <MudMenu Dense="true" AnchorOrigin="Origin.BottomLeft" TransformOrigin="Origin.TopLeft">
                    <ActivatorContent>
                        <MudIconButton Variant="Variant.Filled" Icon="@Icons.Material.Sharp.FormatColorFill" Class="border border-solid" Style="@($"background: linear-gradient(to bottom, var(--mud-palette-background), {BackgroundColor});")" />
                    </ActivatorContent>
                    <ChildContent>
                        <MudColorPicker DisableToolbar="true" DisableColorField="false" DisableModeSwitch="true" DisablePreview="false" DisableAlpha="true" PickerVariant="PickerVariant.Static" Value="BackgroundColor" ValueChanged="SetBackgroundColor" />
                    </ChildContent>
                </MudMenu>
                <MudMenu Dense="true" AnchorOrigin="Origin.BottomLeft" TransformOrigin="Origin.TopLeft">
                    <ActivatorContent>
                        <MudIconButton Variant="Variant.Filled" Icon="@Icons.Material.Sharp.FormatColorText" Class="border border-solid" Style="@($"background: linear-gradient(to bottom, var(--mud-palette-background), {TextColor});")" />
                    </ActivatorContent>
                    <ChildContent>
                        <MudColorPicker DisableToolbar="true" DisableColorField="false" DisableModeSwitch="true" DisablePreview="false" DisableAlpha="true" PickerVariant="PickerVariant.Static" Value="TextColor" ValueChanged="SetTextColor" />
                    </ChildContent>
                </MudMenu>
            </ToolbarRow>
        </ToolbarColumn>
        <ToolbarColumn>
            <ToolbarRow>
                <MudIconButton Variant="Variant.Outlined" Icon="@Icons.Material.Sharp.VerticalAlignTop" />
                <MudIconButton Variant="Variant.Outlined" Icon="@Icons.Material.Sharp.VerticalAlignCenter" />
                <MudIconButton Variant="Variant.Outlined" Icon="@Icons.Material.Sharp.VerticalAlignBottom" />
            </ToolbarRow>
            <ToolbarRow>
                <MudIconButton Variant="Variant.Outlined" Icon="@Icons.Material.Sharp.FormatAlignLeft" />
                <MudIconButton Variant="Variant.Outlined" Icon="@Icons.Material.Sharp.FormatAlignCenter" />
                <MudIconButton Variant="Variant.Outlined" Icon="@Icons.Material.Sharp.FormatAlignRight" />
            </ToolbarRow>
        </ToolbarColumn>
        <ToolbarColumn>
            
            <ToolbarRow>
                <div style="width: 36px; height: 36px;"/>
            </ToolbarRow>
            <ToolbarRow Class="NoMarginPls">
                <MudTextField T="string" Margin="Margin.Dense" Label="@Localizer["Storlek"]" Variant="Variant.Outlined" Adornment="Adornment.None" AdornmentIcon="@Icons.Material.Sharp.FormatSize" ShrinkLabel="true" Style="width: 75px; ; height: 36px;" Class="nomarginpls" />
            </ToolbarRow>
        </ToolbarColumn>
    </ToolbarRow>
    
</ToolbarSection>

@code{
    [Parameter] public IFormat? Format { get; set; }
    [Parameter] public EventCallback<IFormat> FormatChanged { get; set; }
    [Parameter] public string SectionTitle { get; set; } = string.Empty;
    

    MudColor BackgroundColor = new("#FFFFFF");
    MudColor TextColor = new("#424242");

    protected override void OnParametersSet()
    {
        if (Format?.BackgroundColor is not null)
        {
            BackgroundColor = Format.BackgroundColor;
        }
        if (Format?.TextColor is not null)
        {
            TextColor = Format.TextColor;
        }
    }

    void SetBackgroundColor(MudColor color)
    {
        BackgroundColor = color;
        if (Format is not null)
        {
            Format.BackgroundColor = color.Value;
        }
    }
    void SetTextColor(MudColor color)
    {
        TextColor = color;
        if (Format is not null)
        {
            Format.TextColor = color.Value;
        }
    }

    enum Border
    {
        None,
        Bottom,
        Top,
        Left,
        Right,
        All,
        Outer
    }

    Task SetFontSize(int size)
    {
        if (Format is not null)
        {
            Format.FontSize = size;
            return FormatChanged.InvokeAsync(Format);
        }
        return Task.CompletedTask;
    }
    Task SetIsBold(bool isbold)
    {
        if (Format is not null)
        {
            Format.IsBold = isbold;
            return FormatChanged.InvokeAsync(Format);
        }
        return Task.CompletedTask;
    }
    Task SetIsItalic(bool isItalic)
    {
        if (Format is not null)
        {
            Format.IsItalic = isItalic;
            return FormatChanged.InvokeAsync(Format);
        }
        return Task.CompletedTask;
    }
    Task SetIsUnderlined(bool isUnderlined)
    {
        if (Format is not null)
        {
            Format.IsUnderline = isUnderlined;
            return FormatChanged.InvokeAsync(Format);
        }
        return Task.CompletedTask;
    }
    Task SetBorder(Border border)
    {
        if (Format is not null)
        {
            Action action = border switch
            {
                Border.None => () =>
                {
                    Format.HasBorderBottom = false;
                    Format.HasBorderTop = false;
                    Format.HasBorderLeft = false;
                    Format.HasBorderRight = false;
                },
                Border.Bottom => () =>
                {
                    Format.HasBorderBottom = true;
                    Format.HasBorderTop = false;
                    Format.HasBorderLeft = false;
                    Format.HasBorderRight = false;
                }
                ,
                Border.Top => () =>
                {
                    Format.HasBorderBottom = false;
                    Format.HasBorderTop = true;
                    Format.HasBorderLeft = false;
                    Format.HasBorderRight = false;
                },
                Border.Left => () =>
                {
                    Format.HasBorderBottom = false;
                    Format.HasBorderTop = false;
                    Format.HasBorderLeft = true;
                    Format.HasBorderRight = false;
                },
                Border.Right => () =>
                {
                    Format.HasBorderBottom = false;
                    Format.HasBorderTop = false;
                    Format.HasBorderLeft = false;
                    Format.HasBorderRight = true;
                },
                Border.All => () =>
                {
                    Format.HasBorderBottom = true;
                    Format.HasBorderTop = true;
                    Format.HasBorderLeft = true;
                    Format.HasBorderRight = true;
                },
                Border.Outer => () =>
                {
                    Format.HasBorderBottom = true;
                    Format.HasBorderTop = true;
                    Format.HasBorderLeft = true;
                    Format.HasBorderRight = true;

                },
                _ => () =>
                {
                    Format.HasBorderBottom = false;
                    Format.HasBorderTop = false;
                    Format.HasBorderLeft = false;
                    Format.HasBorderRight = false;
                },
            };
            action.Invoke();
            return FormatChanged.InvokeAsync(Format);
        }
        return Task.CompletedTask;
    }
    
    
}