@page "/Settings/Users"
@layout SettingsLayout
@inject IStringLocalizer<UserListPage> Localizer


<SettingsPageBase>
    <SettingsSection Title="@Localizer["Användare"]" LoadDataAsync="LoadDataAsync">
        <AppPlatform.Shared.Components.Rights.UserPicker AllUsers="Users" EnablePicking="false">
            <ExtraTdContent>
                <MudIconButton Icon="@Icons.Material.Sharp.Edit" Color="Color.Primary" OnClick="() => EditUserAccess(context)" Size="Size.Small" />
            </ExtraTdContent>
        </AppPlatform.Shared.Components.Rights.UserPicker>
    </SettingsSection>
</SettingsPageBase>



@inject IMicrosoftGraphUserAccess MicrosoftGraphUserAccess
@inject NavigationManager NavigationManager

@code{
    List<UserWithPhoto> Users { get; set; } = new();

    async Task LoadDataAsync()
    {
        var users = await MicrosoftGraphUserAccess.GetUsersWithPhotoAsync();
        Users = users.ToList();
        StateHasChanged();
    }
    void EditUserAccess(UserWithPhoto user)
    {
        NavigationManager.NavigateTo($"{Constants.ModuleRoutes.UserAccessEdit}/{user.User.Id}");
    }
}